
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="topsecret">
      
      
        <meta name="author" content="Emiliano Dalla Verde Marcozzi">
      
      
        <link rel="canonical" href="https://edvm.github.io/secrets-py/domain/">
      
      
        <link rel="prev" href="../adapters/webapi/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Secrets - Top secret documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#topsecret.domain" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Top secret documentation" class="md-header__button md-logo" aria-label="Top secret documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Top secret documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Secrets
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/edvm/secrets-py.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    edvm/secrets-py
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Top secret documentation" class="md-nav__button md-logo" aria-label="Top secret documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Top secret documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/edvm/secrets-py.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    edvm/secrets-py
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Encryption
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Encryption
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../infra/cipher/aes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AES cipher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/encryption/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Encryption service
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Storage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Storage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../infra/storage/inmem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    In memory (for dev)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Delivery
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Delivery
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adapters/webapi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rest API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Domain
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Domain
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Secrets
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Secrets
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#topsecret.domain" class="md-nav__link">
    <span class="md-ellipsis">
      domain
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#topsecret.domain.CipherProtocol" class="md-nav__link">
    <span class="md-ellipsis">
      CipherProtocol
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CipherProtocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#topsecret.domain.CipherProtocol.decrypt" class="md-nav__link">
    <span class="md-ellipsis">
      decrypt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topsecret.domain.CipherProtocol.encrypt" class="md-nav__link">
    <span class="md-ellipsis">
      encrypt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#topsecret.domain.CipherStorageProtocol" class="md-nav__link">
    <span class="md-ellipsis">
      CipherStorageProtocol
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CipherStorageProtocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#topsecret.domain.CipherStorageProtocol.contains" class="md-nav__link">
    <span class="md-ellipsis">
      contains
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topsecret.domain.CipherStorageProtocol.retrieve" class="md-nav__link">
    <span class="md-ellipsis">
      retrieve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topsecret.domain.CipherStorageProtocol.store" class="md-nav__link">
    <span class="md-ellipsis">
      store
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#topsecret.domain.DecryptionError" class="md-nav__link">
    <span class="md-ellipsis">
      DecryptionError
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DecryptionError">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#topsecret.domain.DecryptionError.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#topsecret.domain" class="md-nav__link">
    <span class="md-ellipsis">
      domain
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#topsecret.domain.CipherProtocol" class="md-nav__link">
    <span class="md-ellipsis">
      CipherProtocol
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CipherProtocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#topsecret.domain.CipherProtocol.decrypt" class="md-nav__link">
    <span class="md-ellipsis">
      decrypt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topsecret.domain.CipherProtocol.encrypt" class="md-nav__link">
    <span class="md-ellipsis">
      encrypt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#topsecret.domain.CipherStorageProtocol" class="md-nav__link">
    <span class="md-ellipsis">
      CipherStorageProtocol
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CipherStorageProtocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#topsecret.domain.CipherStorageProtocol.contains" class="md-nav__link">
    <span class="md-ellipsis">
      contains
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topsecret.domain.CipherStorageProtocol.retrieve" class="md-nav__link">
    <span class="md-ellipsis">
      retrieve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topsecret.domain.CipherStorageProtocol.store" class="md-nav__link">
    <span class="md-ellipsis">
      store
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#topsecret.domain.DecryptionError" class="md-nav__link">
    <span class="md-ellipsis">
      DecryptionError
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DecryptionError">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#topsecret.domain.DecryptionError.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Secrets</h1>

<p>Domain layer is the core of the application. It contains interfaces and business logic. It is independent of any framework or technology. It should not depend on any other layer. It should only depend on the entities and value objects. </p>


<div class="doc doc-object doc-module">



<a id="topsecret.domain"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="topsecret.domain.CipherProtocol" class="doc doc-heading">
            <code>CipherProtocol</code>


<a href="#topsecret.domain.CipherProtocol" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Protocol">Protocol</span></code></p>


        <p>Defines a protocol for cryptographic operations, specifically encrypting and
decrypting byte data.</p>
<p>This protocol outlines the contract for classes that provide encryption and
decryption functionalities. Implementations are expected to handle the
conversion of plaintext data into a secure, encrypted format (ciphertext)
and vice-versa. The protocol supports operations with an optional passphrase,
allowing for both passphrase-based encryption and potentially other key
management schemes.</p>
<p>The <code>Ciphertext</code> and <code>Metadata</code> types mentioned in method signatures are
placeholders for the specific types that an implementing class would use for
encrypted data and its associated metadata, respectively.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="topsecret.domain.CipherProtocol.AUTO_KEY_SEP">AUTO_KEY_SEP</span></code></td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A class-level constant representing a byte sequence
(b"|"). This separator is intended for use in "auto encryption"
scenarios. While the specific mechanism of "auto encryption" is not
defined by this protocol, this separator likely plays a role in
demarcating or structuring data when keys are managed automatically
or embedded within the ciphertext or metadata.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>topsecret/domain.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CipherProtocol</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Defines a protocol for cryptographic operations, specifically encrypting and</span>
<span class="sd">    decrypting byte data.</span>

<span class="sd">    This protocol outlines the contract for classes that provide encryption and</span>
<span class="sd">    decryption functionalities. Implementations are expected to handle the</span>
<span class="sd">    conversion of plaintext data into a secure, encrypted format (ciphertext)</span>
<span class="sd">    and vice-versa. The protocol supports operations with an optional passphrase,</span>
<span class="sd">    allowing for both passphrase-based encryption and potentially other key</span>
<span class="sd">    management schemes.</span>

<span class="sd">    The `Ciphertext` and `Metadata` types mentioned in method signatures are</span>
<span class="sd">    placeholders for the specific types that an implementing class would use for</span>
<span class="sd">    encrypted data and its associated metadata, respectively.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        AUTO_KEY_SEP (bytes): A class-level constant representing a byte sequence</span>
<span class="sd">            (b&quot;|&quot;). This separator is intended for use in &quot;auto encryption&quot;</span>
<span class="sd">            scenarios. While the specific mechanism of &quot;auto encryption&quot; is not</span>
<span class="sd">            defined by this protocol, this separator likely plays a role in</span>
<span class="sd">            demarcating or structuring data when keys are managed automatically</span>
<span class="sd">            or embedded within the ciphertext or metadata.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Encrypt/Decrypt bytes.&quot;&quot;&quot;</span>

    <span class="n">AUTO_KEY_SEP</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;|&quot;</span>  <span class="c1"># for auto encryption</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">encrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">passphrase</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Ciphertext</span><span class="p">,</span> <span class="n">Metadata</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Encrypts the provided byte data.</span>

<span class="sd">        This method takes raw byte data and an optional passphrase, processes it</span>
<span class="sd">        through an encryption algorithm, and returns the resulting ciphertext</span>
<span class="sd">        along with associated metadata. The metadata is crucial as it may contain</span>
<span class="sd">        information required for successful decryption, such as initialization</span>
<span class="sd">        vectors (IVs), salts, or parameters related to the encryption algorithm</span>
<span class="sd">        or key derivation.</span>

<span class="sd">        If a passphrase is not provided, the implementation is expected to handle</span>
<span class="sd">        key management. This could involve generating a new key, using a</span>
<span class="sd">        pre-configured key, or employing a mechanism related to &quot;auto encryption&quot;</span>
<span class="sd">        (potentially using `AUTO_KEY_SEP`). The specifics of this behavior are</span>
<span class="sd">        left to the implementing class.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (bytes): The raw byte data to be encrypted.</span>
<span class="sd">            passphrase (str | None): An optional passphrase to be used for deriving</span>
<span class="sd">                the encryption key. If None, the encryption method should define</span>
<span class="sd">                its behavior for key generation or retrieval according to its</span>
<span class="sd">                key management strategy.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[Ciphertext, Metadata]: A tuple containing two elements:</span>
<span class="sd">                - Ciphertext: The encrypted version of the input `data`. The exact</span>
<span class="sd">                type or structure of `Ciphertext` is not defined by this protocol</span>
<span class="sd">                but is expected to be the encrypted payload.</span>
<span class="sd">                - Metadata: Ancillary information required or useful for the</span>
<span class="sd">                decryption process. This could include salts, IVs, algorithm</span>
<span class="sd">                identifiers, or other cryptographic parameters. The exact type</span>
<span class="sd">                or structure of `Metadata` is also implementation-dependent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">:</span> <span class="n">Ciphertext</span><span class="p">,</span> <span class="n">metadata</span><span class="p">:</span> <span class="n">Metadata</span><span class="p">,</span> <span class="n">passphrase</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Decrypts the given ciphertext back into its original string form.</span>

<span class="sd">        This method takes ciphertext and its associated metadata, along with an</span>
<span class="sd">        optional passphrase, to reverse the encryption process. It attempts to</span>
<span class="sd">        decrypt the data and then decodes the resulting bytes into a string.</span>
<span class="sd">        The successful execution of this method relies on the correct ciphertext,</span>
<span class="sd">        metadata, and, if used during encryption, the correct passphrase.</span>

<span class="sd">        The metadata provided must correspond to the metadata generated during the</span>
<span class="sd">        encryption of the `ciphertext`. If a passphrase was used for encryption,</span>
<span class="sd">        the same passphrase must be provided for decryption. If no passphrase was</span>
<span class="sd">        used (e.g., in an &quot;auto encryption&quot; scenario where the key is managed</span>
<span class="sd">        differently), providing `None` for the passphrase argument should allow</span>
<span class="sd">        the decryption process to proceed using the implementation&#39;s key management</span>
<span class="sd">        strategy.</span>

<span class="sd">        The return type of `str` implies that the original data, before encryption,</span>
<span class="sd">        was text that was encoded into bytes (e.g., using UTF-8) and, upon</span>
<span class="sd">        decryption, is decoded back into a string using an appropriate encoding</span>
<span class="sd">        assumed by the implementation.</span>

<span class="sd">        Args:</span>
<span class="sd">            ciphertext (Ciphertext): The encrypted data to be decrypted. This should</span>
<span class="sd">                be the `Ciphertext` object obtained from a compatible `encrypt` method.</span>
<span class="sd">            metadata (Metadata): The metadata associated with the `ciphertext`. This</span>
<span class="sd">                should be the `Metadata` object obtained from a compatible `encrypt`</span>
<span class="sd">                method, containing all necessary information for decryption.</span>
<span class="sd">            passphrase (str | None): The passphrase that was used to encrypt the</span>
<span class="sd">                data. If no passphrase was used during encryption (e.g., key was</span>
<span class="sd">                auto-generated and managed), this should be `None`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The decrypted data, decoded into a string.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: While not explicitly defined in the protocol, implementations</span>
<span class="sd">                are expected to raise an appropriate exception (e.g., a custom</span>
<span class="sd">                `DecryptionError`, `ValueError`, or a cryptography-specific error)</span>
<span class="sd">                if the decryption fails. This could be due to an incorrect</span>
<span class="sd">                passphrase, corrupted data, tampered ciphertext/metadata, or</span>
<span class="sd">                mismatched cryptographic parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="topsecret.domain.CipherProtocol.decrypt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">passphrase</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#topsecret.domain.CipherProtocol.decrypt" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Decrypts the given ciphertext back into its original string form.</p>
<p>This method takes ciphertext and its associated metadata, along with an
optional passphrase, to reverse the encryption process. It attempts to
decrypt the data and then decodes the resulting bytes into a string.
The successful execution of this method relies on the correct ciphertext,
metadata, and, if used during encryption, the correct passphrase.</p>
<p>The metadata provided must correspond to the metadata generated during the
encryption of the <code>ciphertext</code>. If a passphrase was used for encryption,
the same passphrase must be provided for decryption. If no passphrase was
used (e.g., in an "auto encryption" scenario where the key is managed
differently), providing <code>None</code> for the passphrase argument should allow
the decryption process to proceed using the implementation's key management
strategy.</p>
<p>The return type of <code>str</code> implies that the original data, before encryption,
was text that was encoded into bytes (e.g., using UTF-8) and, upon
decryption, is decoded back into a string using an appropriate encoding
assumed by the implementation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ciphertext</code>
            </td>
            <td>
                  <code><span title="topsecret.domain.Ciphertext">Ciphertext</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The encrypted data to be decrypted. This should
be the <code>Ciphertext</code> object obtained from a compatible <code>encrypt</code> method.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="topsecret.domain.Metadata">Metadata</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The metadata associated with the <code>ciphertext</code>. This
should be the <code>Metadata</code> object obtained from a compatible <code>encrypt</code>
method, containing all necessary information for decryption.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>passphrase</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The passphrase that was used to encrypt the
data. If no passphrase was used during encryption (e.g., key was
auto-generated and managed), this should be <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The decrypted data, decoded into a string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>While not explicitly defined in the protocol, implementations
are expected to raise an appropriate exception (e.g., a custom
<code>DecryptionError</code>, <code>ValueError</code>, or a cryptography-specific error)
if the decryption fails. This could be due to an incorrect
passphrase, corrupted data, tampered ciphertext/metadata, or
mismatched cryptographic parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>topsecret/domain.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">decrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">:</span> <span class="n">Ciphertext</span><span class="p">,</span> <span class="n">metadata</span><span class="p">:</span> <span class="n">Metadata</span><span class="p">,</span> <span class="n">passphrase</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decrypts the given ciphertext back into its original string form.</span>

<span class="sd">    This method takes ciphertext and its associated metadata, along with an</span>
<span class="sd">    optional passphrase, to reverse the encryption process. It attempts to</span>
<span class="sd">    decrypt the data and then decodes the resulting bytes into a string.</span>
<span class="sd">    The successful execution of this method relies on the correct ciphertext,</span>
<span class="sd">    metadata, and, if used during encryption, the correct passphrase.</span>

<span class="sd">    The metadata provided must correspond to the metadata generated during the</span>
<span class="sd">    encryption of the `ciphertext`. If a passphrase was used for encryption,</span>
<span class="sd">    the same passphrase must be provided for decryption. If no passphrase was</span>
<span class="sd">    used (e.g., in an &quot;auto encryption&quot; scenario where the key is managed</span>
<span class="sd">    differently), providing `None` for the passphrase argument should allow</span>
<span class="sd">    the decryption process to proceed using the implementation&#39;s key management</span>
<span class="sd">    strategy.</span>

<span class="sd">    The return type of `str` implies that the original data, before encryption,</span>
<span class="sd">    was text that was encoded into bytes (e.g., using UTF-8) and, upon</span>
<span class="sd">    decryption, is decoded back into a string using an appropriate encoding</span>
<span class="sd">    assumed by the implementation.</span>

<span class="sd">    Args:</span>
<span class="sd">        ciphertext (Ciphertext): The encrypted data to be decrypted. This should</span>
<span class="sd">            be the `Ciphertext` object obtained from a compatible `encrypt` method.</span>
<span class="sd">        metadata (Metadata): The metadata associated with the `ciphertext`. This</span>
<span class="sd">            should be the `Metadata` object obtained from a compatible `encrypt`</span>
<span class="sd">            method, containing all necessary information for decryption.</span>
<span class="sd">        passphrase (str | None): The passphrase that was used to encrypt the</span>
<span class="sd">            data. If no passphrase was used during encryption (e.g., key was</span>
<span class="sd">            auto-generated and managed), this should be `None`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The decrypted data, decoded into a string.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: While not explicitly defined in the protocol, implementations</span>
<span class="sd">            are expected to raise an appropriate exception (e.g., a custom</span>
<span class="sd">            `DecryptionError`, `ValueError`, or a cryptography-specific error)</span>
<span class="sd">            if the decryption fails. This could be due to an incorrect</span>
<span class="sd">            passphrase, corrupted data, tampered ciphertext/metadata, or</span>
<span class="sd">            mismatched cryptographic parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="topsecret.domain.CipherProtocol.encrypt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">encrypt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">passphrase</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#topsecret.domain.CipherProtocol.encrypt" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Encrypts the provided byte data.</p>
<p>This method takes raw byte data and an optional passphrase, processes it
through an encryption algorithm, and returns the resulting ciphertext
along with associated metadata. The metadata is crucial as it may contain
information required for successful decryption, such as initialization
vectors (IVs), salts, or parameters related to the encryption algorithm
or key derivation.</p>
<p>If a passphrase is not provided, the implementation is expected to handle
key management. This could involve generating a new key, using a
pre-configured key, or employing a mechanism related to "auto encryption"
(potentially using <code>AUTO_KEY_SEP</code>). The specifics of this behavior are
left to the implementing class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The raw byte data to be encrypted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>passphrase</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional passphrase to be used for deriving
the encryption key. If None, the encryption method should define
its behavior for key generation or retrieval according to its
key management strategy.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="topsecret.domain.Ciphertext">Ciphertext</span>, <span title="topsecret.domain.Metadata">Metadata</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[Ciphertext, Metadata]: A tuple containing two elements:
- Ciphertext: The encrypted version of the input <code>data</code>. The exact
type or structure of <code>Ciphertext</code> is not defined by this protocol
but is expected to be the encrypted payload.
- Metadata: Ancillary information required or useful for the
decryption process. This could include salts, IVs, algorithm
identifiers, or other cryptographic parameters. The exact type
or structure of <code>Metadata</code> is also implementation-dependent.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>topsecret/domain.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">encrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">passphrase</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Ciphertext</span><span class="p">,</span> <span class="n">Metadata</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Encrypts the provided byte data.</span>

<span class="sd">    This method takes raw byte data and an optional passphrase, processes it</span>
<span class="sd">    through an encryption algorithm, and returns the resulting ciphertext</span>
<span class="sd">    along with associated metadata. The metadata is crucial as it may contain</span>
<span class="sd">    information required for successful decryption, such as initialization</span>
<span class="sd">    vectors (IVs), salts, or parameters related to the encryption algorithm</span>
<span class="sd">    or key derivation.</span>

<span class="sd">    If a passphrase is not provided, the implementation is expected to handle</span>
<span class="sd">    key management. This could involve generating a new key, using a</span>
<span class="sd">    pre-configured key, or employing a mechanism related to &quot;auto encryption&quot;</span>
<span class="sd">    (potentially using `AUTO_KEY_SEP`). The specifics of this behavior are</span>
<span class="sd">    left to the implementing class.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (bytes): The raw byte data to be encrypted.</span>
<span class="sd">        passphrase (str | None): An optional passphrase to be used for deriving</span>
<span class="sd">            the encryption key. If None, the encryption method should define</span>
<span class="sd">            its behavior for key generation or retrieval according to its</span>
<span class="sd">            key management strategy.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[Ciphertext, Metadata]: A tuple containing two elements:</span>
<span class="sd">            - Ciphertext: The encrypted version of the input `data`. The exact</span>
<span class="sd">            type or structure of `Ciphertext` is not defined by this protocol</span>
<span class="sd">            but is expected to be the encrypted payload.</span>
<span class="sd">            - Metadata: Ancillary information required or useful for the</span>
<span class="sd">            decryption process. This could include salts, IVs, algorithm</span>
<span class="sd">            identifiers, or other cryptographic parameters. The exact type</span>
<span class="sd">            or structure of `Metadata` is also implementation-dependent.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="topsecret.domain.CipherStorageProtocol" class="doc doc-heading">
            <code>CipherStorageProtocol</code>


<a href="#topsecret.domain.CipherStorageProtocol" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Generic">Generic</span>[<span title="topsecret.domain.K">K</span>, <span title="topsecret.domain.V">V</span>]</code>, <code><span title="typing.Protocol">Protocol</span></code></p>


        <p>Protocol for a generic key-value storage mechanism.</p>
<p>This class defines a protocol that specifies an interface for
storing, retrieving, and checking the existence of key-value pairs. It is
designed to be generic, utilizing type variables <code>K</code> for keys and <code>V</code> for
values. This allows concrete implementations to define the specific types
they handle, promoting flexibility and type safety.</p>
<p>The primary purpose of this protocol is to abstract the underlying storage
mechanism. Implementers could use various backends, such as in-memory
dictionaries for testing, databases for persistent storage, or distributed
caches for scalable solutions. By adhering to this protocol, different
storage implementations can be used interchangeably within an application.</p>
<p>In the context of cipher management or secure data handling (as suggested by
the name "CipherStorageProtocol"), <code>K</code> might represent a unique identifier
for a cryptographic key, a cipher suite, or a protected data entry. <code>V</code>
could then be the actual cryptographic material (e.g., an encryption key,
a PGP key object), a configuration object for a cipher, or the encrypted
data itself.</p>
<p>Implementations are expected to provide the logic for:
- <code>retrieve(key)</code>: Fetching a value given its key.
- <code>store(key, value)</code>: Persisting a key-value pair.
- <code>contains(key)</code>: Verifying if a key is present in the storage.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>K</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TypeVar representing the type of the keys in the storage. This allows
for flexibility in choosing key types, such as strings, integers, or
custom hashable objects.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>V</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TypeVar representing the type of the values in the storage. This allows
for storing various kinds of data, from simple types to complex objects
or serialized data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>topsecret/domain.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CipherStorageProtocol</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">Generic</span><span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">V</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Protocol for a generic key-value storage mechanism.</span>

<span class="sd">    This class defines a protocol that specifies an interface for</span>
<span class="sd">    storing, retrieving, and checking the existence of key-value pairs. It is</span>
<span class="sd">    designed to be generic, utilizing type variables `K` for keys and `V` for</span>
<span class="sd">    values. This allows concrete implementations to define the specific types</span>
<span class="sd">    they handle, promoting flexibility and type safety.</span>

<span class="sd">    The primary purpose of this protocol is to abstract the underlying storage</span>
<span class="sd">    mechanism. Implementers could use various backends, such as in-memory</span>
<span class="sd">    dictionaries for testing, databases for persistent storage, or distributed</span>
<span class="sd">    caches for scalable solutions. By adhering to this protocol, different</span>
<span class="sd">    storage implementations can be used interchangeably within an application.</span>

<span class="sd">    In the context of cipher management or secure data handling (as suggested by</span>
<span class="sd">    the name &quot;CipherStorageProtocol&quot;), `K` might represent a unique identifier</span>
<span class="sd">    for a cryptographic key, a cipher suite, or a protected data entry. `V`</span>
<span class="sd">    could then be the actual cryptographic material (e.g., an encryption key,</span>
<span class="sd">    a PGP key object), a configuration object for a cipher, or the encrypted</span>
<span class="sd">    data itself.</span>

<span class="sd">    Implementations are expected to provide the logic for:</span>
<span class="sd">    - `retrieve(key)`: Fetching a value given its key.</span>
<span class="sd">    - `store(key, value)`: Persisting a key-value pair.</span>
<span class="sd">    - `contains(key)`: Verifying if a key is present in the storage.</span>

<span class="sd">    Args:</span>
<span class="sd">        K: TypeVar representing the type of the keys in the storage. This allows</span>
<span class="sd">            for flexibility in choosing key types, such as strings, integers, or</span>
<span class="sd">            custom hashable objects.</span>
<span class="sd">        V: TypeVar representing the type of the values in the storage. This allows</span>
<span class="sd">            for storing various kinds of data, from simple types to complex objects</span>
<span class="sd">            or serialized data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">retrieve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">K</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">V</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves the value associated with the given key.</span>

<span class="sd">        This method attempts to find an entry in the storage that matches the</span>
<span class="sd">        provided key. If a corresponding value exists, it is returned. If the</span>
<span class="sd">        key is not found in the storage, this method must return `None`.</span>
<span class="sd">        This explicit `None` return for non-existent keys allows callers to</span>
<span class="sd">        reliably distinguish between a key not being found and a key being</span>
<span class="sd">        associated with a `None` value (if `V` itself can be `NoneType`).</span>

<span class="sd">        Args:</span>
<span class="sd">            key (K): The key whose associated value is to be retrieved. The type</span>
<span class="sd">                of the key must match the generic type `K` defined by the</span>
<span class="sd">                implementing class.</span>

<span class="sd">        Returns:</span>
<span class="sd">            V | None: The value associated with the specified `key` if it exists</span>
<span class="sd">                within the storage. Returns `None` if the `key` is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">K</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">V</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stores a key-value pair in the storage.</span>

<span class="sd">        This method is responsible for persisting the given `value` under the</span>
<span class="sd">        specified `key`. If the `key` already exists in the storage, the</span>
<span class="sd">        behavior (e.g., overwrite the existing value, raise an error, or ignore</span>
<span class="sd">        the operation) is typically defined by the concrete implementation of</span>
<span class="sd">        this protocol. However, a common expectation for key-value stores is</span>
<span class="sd">        that the new value will replace any existing value for that key.</span>

<span class="sd">        The method is expected to complete the storage operation and ensure the</span>
<span class="sd">        key-value pair is durably or appropriately stored according to the</span>
<span class="sd">        implementation&#39;s guarantees.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (K): The key under which the `value` is to be stored. Its type</span>
<span class="sd">                must conform to the generic type `K` of the protocol.</span>
<span class="sd">            value (V): The value to be stored. Its type must conform to the</span>
<span class="sd">                generic type `V` of the protocol.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: This method does not return any value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">K</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if a key exists in the storage.</span>

<span class="sd">        This method determines whether the storage holds any value associated</span>
<span class="sd">        with the given `key`. It provides an efficient way to query the</span>
<span class="sd">        existence of a key without incurring the potential overhead of</span>
<span class="sd">        retrieving the actual value (as the `retrieve` method would do).</span>

<span class="sd">        This is particularly useful for pre-flight checks before attempting</span>
<span class="sd">        a `retrieve` or `store` operation (e.g., to decide whether to update</span>
<span class="sd">        or insert), or for any logic that depends on the presence or absence</span>
<span class="sd">        of a key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (K): The key to check for existence in the storage. Its type</span>
<span class="sd">                must conform to the generic type `K` of the protocol.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: `True` if the `key` is found in the storage, `False` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="topsecret.domain.CipherStorageProtocol.contains" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contains</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#topsecret.domain.CipherStorageProtocol.contains" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Checks if a key exists in the storage.</p>
<p>This method determines whether the storage holds any value associated
with the given <code>key</code>. It provides an efficient way to query the
existence of a key without incurring the potential overhead of
retrieving the actual value (as the <code>retrieve</code> method would do).</p>
<p>This is particularly useful for pre-flight checks before attempting
a <code>retrieve</code> or <code>store</code> operation (e.g., to decide whether to update
or insert), or for any logic that depends on the presence or absence
of a key.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="topsecret.domain.K">K</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key to check for existence in the storage. Its type
must conform to the generic type <code>K</code> of the protocol.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if the <code>key</code> is found in the storage, <code>False</code> otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>topsecret/domain.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">K</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if a key exists in the storage.</span>

<span class="sd">    This method determines whether the storage holds any value associated</span>
<span class="sd">    with the given `key`. It provides an efficient way to query the</span>
<span class="sd">    existence of a key without incurring the potential overhead of</span>
<span class="sd">    retrieving the actual value (as the `retrieve` method would do).</span>

<span class="sd">    This is particularly useful for pre-flight checks before attempting</span>
<span class="sd">    a `retrieve` or `store` operation (e.g., to decide whether to update</span>
<span class="sd">    or insert), or for any logic that depends on the presence or absence</span>
<span class="sd">    of a key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (K): The key to check for existence in the storage. Its type</span>
<span class="sd">            must conform to the generic type `K` of the protocol.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: `True` if the `key` is found in the storage, `False` otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="topsecret.domain.CipherStorageProtocol.retrieve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">retrieve</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#topsecret.domain.CipherStorageProtocol.retrieve" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieves the value associated with the given key.</p>
<p>This method attempts to find an entry in the storage that matches the
provided key. If a corresponding value exists, it is returned. If the
key is not found in the storage, this method must return <code>None</code>.
This explicit <code>None</code> return for non-existent keys allows callers to
reliably distinguish between a key not being found and a key being
associated with a <code>None</code> value (if <code>V</code> itself can be <code>NoneType</code>).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="topsecret.domain.K">K</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key whose associated value is to be retrieved. The type
of the key must match the generic type <code>K</code> defined by the
implementing class.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="topsecret.domain.V">V</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>V | None: The value associated with the specified <code>key</code> if it exists
within the storage. Returns <code>None</code> if the <code>key</code> is not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>topsecret/domain.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">retrieve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">K</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">V</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves the value associated with the given key.</span>

<span class="sd">    This method attempts to find an entry in the storage that matches the</span>
<span class="sd">    provided key. If a corresponding value exists, it is returned. If the</span>
<span class="sd">    key is not found in the storage, this method must return `None`.</span>
<span class="sd">    This explicit `None` return for non-existent keys allows callers to</span>
<span class="sd">    reliably distinguish between a key not being found and a key being</span>
<span class="sd">    associated with a `None` value (if `V` itself can be `NoneType`).</span>

<span class="sd">    Args:</span>
<span class="sd">        key (K): The key whose associated value is to be retrieved. The type</span>
<span class="sd">            of the key must match the generic type `K` defined by the</span>
<span class="sd">            implementing class.</span>

<span class="sd">    Returns:</span>
<span class="sd">        V | None: The value associated with the specified `key` if it exists</span>
<span class="sd">            within the storage. Returns `None` if the `key` is not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="topsecret.domain.CipherStorageProtocol.store" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">store</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#topsecret.domain.CipherStorageProtocol.store" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Stores a key-value pair in the storage.</p>
<p>This method is responsible for persisting the given <code>value</code> under the
specified <code>key</code>. If the <code>key</code> already exists in the storage, the
behavior (e.g., overwrite the existing value, raise an error, or ignore
the operation) is typically defined by the concrete implementation of
this protocol. However, a common expectation for key-value stores is
that the new value will replace any existing value for that key.</p>
<p>The method is expected to complete the storage operation and ensure the
key-value pair is durably or appropriately stored according to the
implementation's guarantees.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="topsecret.domain.K">K</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key under which the <code>value</code> is to be stored. Its type
must conform to the generic type <code>K</code> of the protocol.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="topsecret.domain.V">V</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to be stored. Its type must conform to the
generic type <code>V</code> of the protocol.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This method does not return any value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>topsecret/domain.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">K</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">V</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stores a key-value pair in the storage.</span>

<span class="sd">    This method is responsible for persisting the given `value` under the</span>
<span class="sd">    specified `key`. If the `key` already exists in the storage, the</span>
<span class="sd">    behavior (e.g., overwrite the existing value, raise an error, or ignore</span>
<span class="sd">    the operation) is typically defined by the concrete implementation of</span>
<span class="sd">    this protocol. However, a common expectation for key-value stores is</span>
<span class="sd">    that the new value will replace any existing value for that key.</span>

<span class="sd">    The method is expected to complete the storage operation and ensure the</span>
<span class="sd">    key-value pair is durably or appropriately stored according to the</span>
<span class="sd">    implementation&#39;s guarantees.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (K): The key under which the `value` is to be stored. Its type</span>
<span class="sd">            must conform to the generic type `K` of the protocol.</span>
<span class="sd">        value (V): The value to be stored. Its type must conform to the</span>
<span class="sd">            generic type `V` of the protocol.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: This method does not return any value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="topsecret.domain.DecryptionError" class="doc doc-heading">
            <code>DecryptionError</code>


<a href="#topsecret.domain.DecryptionError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Custom exception raised when decryption fails.</p>
<p>This exception is typically raised when an attempt to decrypt data does not
succeed. This can occur for several reasons, such as:
    1. The provided passphrase or key is incorrect.
    2. The ciphertext has been tampered with or is corrupted.
    3. The encryption algorithm or mode of operation used during encryption
       is different from what is being used for decryption.
    4. The ciphertext is not in the expected format.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="topsecret.domain.DecryptionError.message">message</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A human-readable string describing the error.
If no message is provided during instantiation, a default
message is used.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>topsecret/domain.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DecryptionError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom exception raised when decryption fails.</span>

<span class="sd">    This exception is typically raised when an attempt to decrypt data does not</span>
<span class="sd">    succeed. This can occur for several reasons, such as:</span>
<span class="sd">        1. The provided passphrase or key is incorrect.</span>
<span class="sd">        2. The ciphertext has been tampered with or is corrupted.</span>
<span class="sd">        3. The encryption algorithm or mode of operation used during encryption</span>
<span class="sd">           is different from what is being used for decryption.</span>
<span class="sd">        4. The ciphertext is not in the expected format.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        message (str): A human-readable string describing the error.</span>
<span class="sd">            If no message is provided during instantiation, a default</span>
<span class="sd">            message is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes a new DecryptionError instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            message (str, optional): A custom message describing the specific</span>
<span class="sd">                decryption error. If an empty string or no message is provided,</span>
<span class="sd">                a default error message &quot;Failed to decrypt the data. The</span>
<span class="sd">                ciphertext may be corrupted or the passphrase is incorrect.&quot;</span>
<span class="sd">                will be used. This allows for more specific error reporting</span>
<span class="sd">                when the cause of the decryption failure is known, while</span>
<span class="sd">                providing a generic message otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;Failed to decrypt the data. The ciphertext may be corrupted or the passphrase is incorrect.&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span> <span class="ow">or</span> <span class="n">default</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="topsecret.domain.DecryptionError.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

<a href="#topsecret.domain.DecryptionError.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initializes a new DecryptionError instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A custom message describing the specific
decryption error. If an empty string or no message is provided,
a default error message "Failed to decrypt the data. The
ciphertext may be corrupted or the passphrase is incorrect."
will be used. This allows for more specific error reporting
when the cause of the decryption failure is known, while
providing a generic message otherwise.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>topsecret/domain.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes a new DecryptionError instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        message (str, optional): A custom message describing the specific</span>
<span class="sd">            decryption error. If an empty string or no message is provided,</span>
<span class="sd">            a default error message &quot;Failed to decrypt the data. The</span>
<span class="sd">            ciphertext may be corrupted or the passphrase is incorrect.&quot;</span>
<span class="sd">            will be used. This allows for more specific error reporting</span>
<span class="sd">            when the cause of the decryption failure is known, while</span>
<span class="sd">            providing a generic message otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;Failed to decrypt the data. The ciphertext may be corrupted or the passphrase is incorrect.&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span> <span class="ow">or</span> <span class="n">default</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Maintained by <a href="https://github.com/edvm/">edvm</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/edvm/topsecret" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/topsecret" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>